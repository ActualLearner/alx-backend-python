pipeline {
    agent any  // run on any available Jenkins agent

    stages {
        stage('Checkout') {
            steps {
                git 'https://github.com/ActualLearner/alx-backend-python.git'
            }
        }

        stage('Install Dependencies') {
            steps {
                // Install Python dependencies
                sh 'python3 -m venv venv'      // optional virtual environment
                sh '. venv/bin/activate && pip install --upgrade pip'
                sh '. venv/bin/activate && pip install -r requirements.txt'
            }
        }

        stage('Run Tests') {
            steps {
                // Run pytest and generate a report in JUnit XML format
                sh '. venv/bin/activate && pytest --junitxml=reports/test-results.xml'
            }
            post {
                always {
                    // Archive test results so Jenkins can display them
                    junit 'reports/test-results.xml'
                }
            }
        }
    }
}

